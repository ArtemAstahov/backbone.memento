// Backbone.Memento v0.4.0
//
// Copyright (C)2011 Derick Bailey, Muted Solutions, LLC
// Distributed Under MIT Liscene
//
// Documentation and Full Licence Availabe at:
// http://github.com/derickbailey/backbone.memento

// ----------------------------
// Backbone.Memento
// ----------------------------
Backbone.Memento=function(h,i){var m=function(b){b instanceof h.Model?(this.removeAttr=function(a){b.unset(a)},this.restore=function(a){b.set(a)}):(this.removeAttr=function(a){b.remove(a)},this.restore=function(a){b.reset(a)})},n=function(b,a){function c(a,b){a=i.clone(a);if(b.hasOwnProperty("ignore")&&b.ignore.length>0)for(var c in b.ignore)delete a[b.ignore[c]];return a}var d=new m(b);this.serialize=function(){var g=b.toJSON();return g=c(g,a)};this.deserialize=function(g,l){var e=l=i.extend({},
a,l);oldAttrs=c(g,e);var f=b.toJSON(),f=c(f,e);var e=oldAttrs,j=[];if(e&&f)for(var k in f)f.hasOwnProperty(k)&&(e.hasOwnProperty(k)||j.push(k));for(var h in j)d.removeAttr(j[h]);d.restore(oldAttrs)}},o=function(){var b;this.push=function(a){b.push(a)};this.pop=function(){return b.pop()};this.rewind=function(){var a=b[0];b=[];return a};b=[]};return function(b,a){this.version="0.4.0";var a=i.extend({ignore:[]},a),c=new n(b,a),d=new o(b,a);this.store=function(){var a=c.serialize();d.push(a)};this.restore=
function(a){var b=d.pop();b&&c.deserialize(b,a)};this.restart=function(a){var b=d.rewind();b&&c.deserialize(b,a)}}}(Backbone,_);
